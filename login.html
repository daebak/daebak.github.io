<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인</title>
    <meta name="google-signin-client_id" content="489301222321-4jfsu0c92plecja3ofv92qbav38ifuqv.apps.googleusercontent.com">
    <link rel="stylesheet" href="style.css">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
</head>
<body>
    <div class="login-container">
        <h2>로그인</h2>
        <form id="login-form">
            <div class="input-group">
                <label for="email">이메일</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="input-group">
                <label for="password">비밀번호</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit" class="login-button">로그인</button>
        </form>
        <script>
            document.getElementById('login-form').addEventListener('submit', function(event) {
                event.preventDefault(); // 폼 기본 제출 동작 방지
                // 실제 로그인 로직은 여기에 구현 (예: 서버로 이메일, 비밀번호 전송)
                // 지금은 임시로 로그인 성공으로 간주하고 main.html로 이동
                alert('로그인 시도 (임시)');
                window.location.href = 'main.html';
            });
        </script>
        <div class="social-login">
            <p>SNS 계정으로 로그인</p>
            <button class="social-button kakao">
                <img src="https://developers.kakao.com/assets/img/about/logos/kakaolink/kakaolink_btn_medium.png" alt="카카오 로그인">
                카카오 로그인
            </button>
            <!-- Google Sign-In 버튼 wrapper -->
            <div class="custom-google-signin-button-wrapper">
                <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark" data-width="338" data-height="40" data-longtitle="true"></div>
            </div>
            <!-- 기존 구글 로그인 버튼은 숨기거나 제거할 수 있습니다. 우선 숨김 처리합니다.
            <button class="social-button google" style="display: none;">
                <img src="https://developers.google.com/identity/images/g-logo.png" alt="구글 로그인">
                구글 로그인
            </button>
             -->
            <button class="social-button naver">
                <img src="https://static.nid.naver.com/oauth/button_main.png" alt="네이버 로그인">
                네이버 로그인
            </button>
            <button class="social-button apple">
                <img src="https://appleid.cdn-apple.com/appleid/button?height=40&width=300&type=sign-in&color=black&border=false&border_radius=15&locale=ko_KR" alt="Apple 로그인">
                Apple로 로그인
            </button>
        </div>
    </div>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.1/kakao.min.js"
    integrity="sha384-kDljxUXHaJ9xAb2AzRd59KxjrFjzHa5TAoFQ6GbYTCAG0bjM55XohjjDT7tDDC01" crossorigin="anonymous"></script>
    <script>
        // 여기에 카카오 앱의 JavaScript 키를 입력하세요.
        // Kakao.init('YOUR_JAVASCRIPT_KEY'); // 실제 키로 교체해야 합니다.
        // Kakao.isInitialized(); // SDK 초기화 확인 (선택 사항)

        // 임시로 실제 키 없이 초기화 (오류 발생 가능, 실제 키 필요)
        try {
            if (!Kakao.isInitialized()) {
                 // Kakao.init('YOUR_JAVASCRIPT_KEY'); // << 여기에 실제 JavaScript 키를 넣어주세요.
                 // 개발 및 테스트 목적으로는 우선 키 없이 진행하나, 실제 동작을 위해서는 반드시 키가 필요합니다.
                 // alert("카카오 SDK가 초기화되었습니다. (테스트 모드 - 실제 키 필요)");
            }
        } catch(e) {
            console.error("카카오 SDK 초기화 중 오류 발생:", e);
            // alert("카카오 SDK 초기화에 실패했습니다. JavaScript 키를 확인해주세요.");
        }

        const kakaoLoginButton = document.querySelector('.social-button.kakao');
        if (kakaoLoginButton) {
            kakaoLoginButton.addEventListener('click', function() {
                // Kakao.init이 정상적으로 호출되었다고 가정합니다 (실제 키 필요).
                if (typeof Kakao !== 'undefined' && Kakao.isInitialized && Kakao.isInitialized()) {
                    Kakao.Auth.login({
                        success: function(authObj) {
                            console.log(authObj);
                            // 로그인 성공 시, authObj.access_token을 서버로 보내 사용자 정보 조회 및 로그인 처리
                            alert('카카오 로그인 성공! 토큰: ' + authObj.access_token);
                            // 로그인 성공 후 main.html로 리디렉션
                            window.location.href = 'main.html';
                        },
                        fail: function(err) {
                            console.error(err);
                            alert('카카오 로그인 실패: ' + JSON.stringify(err));
                        },
                    });
                } else {
                    alert('카카오 SDK가 초기화되지 않았습니다. JavaScript 키를 확인하고, Kakao.init()을 호출해주세요.');
                }
            });
        }

        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            console.log('ID: ' + profile.getId()); // 중요: 이 ID를 백엔드로 보내지 마세요. ID 토큰을 사용하세요.
            console.log('Name: ' + profile.getName());
            console.log('Image URL: ' + profile.getImageUrl());
            console.log('Email: ' + profile.getEmail()); // 'email' 범위가 없는 경우 null입니다.

            // 로그인 성공 후 추가 작업 (예: 사용자에게 알림, 페이지 리디렉션)
            alert('Google 로그인 성공! \n이름: ' + profile.getName() + '\n이메일: ' + profile.getEmail());

            // 로그인 성공 후 main.html로 리디렉션
            window.location.href = 'main.html';

            // 실제 애플리케이션에서는 ID 토큰을 백엔드로 보내 인증합니다.
            // var id_token = googleUser.getAuthResponse().id_token;
            // console.log("ID Token: " + id_token);
            // 백엔드와 통신하는 로직을 여기에 추가합니다.
        }

        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
                alert('Google 계정에서 로그아웃되었습니다.');
            });
        }
    </script>
    <div style="text-align: center; margin-top: 20px;">
        <a href="#" onclick="signOut();">Google 로그아웃</a>
    </div>
</body>
</html>
